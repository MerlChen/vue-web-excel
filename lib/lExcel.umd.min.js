(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["lExcel"]=t(require("vue")):e["lExcel"]=t(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(e){var t={};function l(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,l),s.l=!0,s.exports}return l.m=e,l.c=t,l.d=function(e,t,o){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(l.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)l.d(o,s,function(t){return e[t]}.bind(null,s));return o},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s="fb15")}({"077d":function(e,t,l){},"3b15":function(e,t,l){"use strict";var o=l("deba"),s=l.n(o);s.a},"491f":function(e,t,l){"use strict";var o=l("077d"),s=l.n(o);s.a},"4f57":function(e,t,l){},"8bbf":function(t,l){t.exports=e},9763:function(e,t,l){},"97ca":function(e,t,l){},"9a35":function(e,t,l){"use strict";var o=l("97ca"),s=l.n(o);s.a},b309:function(e,t,l){"use strict";var o=l("f7bb"),s=l.n(o);s.a},b455:function(e,t,l){"use strict";var o=l("fac1"),s=l.n(o);s.a},deba:function(e,t,l){},f6fd:function(e,t){(function(e){var t="currentScript",l=e.getElementsByTagName("script");t in e||Object.defineProperty(e,t,{get:function(){try{throw new Error}catch(o){var e,t=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(o.stack)||[!1])[1];for(e in l)if(l[e].src==t||"interactive"==l[e].readyState)return l[e];return null}}})})(document)},f7bb:function(e,t,l){},f924:function(e,t,l){"use strict";var o=l("9763"),s=l.n(o);s.a},fab8:function(e,t,l){"use strict";var o=l("4f57"),s=l.n(o);s.a},fac1:function(e,t,l){},fb15:function(e,t,l){"use strict";var o;(l.r(t),"undefined"!==typeof window)&&(l("f6fd"),(o=window.document.currentScript)&&(o=o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(l.p=o[1]));var s=l("8bbf"),i=l.n(s),n=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"components-excel"},[e.showPanel&&"true"===e.showPanel?l("excel-panel",{attrs:{"data-info":e.panelList,store:e.store}}):e._e(),l("excel-content",{class:{"show-panel":e.showPanel&&"true"===e.showPanel},attrs:{store:e.store}})],1)},r=[],a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"components-excel-panel"},[l("div",{staticClass:"title"},[e._v(" "+e._s(e.dataInfo.title)+" ")]),l("div",{staticClass:"left-words-list-container"},e._l(e.dataInfo.list,(function(t,o){return l("div",{key:o,staticClass:"left-words-item"},[l("div",{staticClass:"left-words-item-name",class:{open:t.id===e.selectedData.id},on:{click:function(l){return e.toggleItemData(t)}}},[e._v(" "+e._s(t.name)+" "),l("en-icon",{attrs:{name:"xiayiye",size:"12px"}})],1),l("en-collapse-area",[l("div",{directives:[{name:"show",rawName:"v-show",value:t.id===e.selectedData.id,expression:"item.id === selectedData.id"}],staticClass:"left-words-item-children"},e._l(t.children,(function(t){return l("div",{key:t.id,staticClass:"left-words-children-item",attrs:{draggable:"true"},on:{dragstart:function(l){return e.dragStart(t)}}},[e._v(" "+e._s(t.name)+" ")])})),0)])],1)})),0)])},c=[],d={name:"Panel",props:{dataInfo:{type:Object,default:()=>({})},store:{default:""}},data(){return{selectedData:{}}},methods:{move(e){if(e.from===e.to)return!1},toggleItemData(e){e.id!==this.selectedData.id?this.selectedData=e:this.selectedData={}},dragStart(e){this.store.dragData=e}}},h=d;l("b309");function f(e,t,l,o,s,i,n,r){var a,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=l,c._compiled=!0),o&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),n?(a=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=a):s&&(a=r?function(){s.call(this,this.$root.$options.shadowRoot)}:s),a)if(c.functional){c._injectStyles=a;var d=c.render;c.render=function(e,t){return a.call(t),d(e,t)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,a):[a]}return{exports:e,options:c}}var u=f(h,a,c,!1,null,"4724980e",null),C=u.exports,m=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"components-excel-content"},[l("excel-toolbar",{attrs:{store:e.store}}),l("table",{attrs:{cellpadding:"0",cellspacing:"0",border:"none"}},e._l(e.store.allCells,(function(t,o){return l("tr",{key:o},e._l(t,(function(t){return l("excel-cell",{key:t.id,class:{during:t.wasDuring},attrs:{"data-info":t,store:e.store,draggable:"false"},nativeOn:{mousedown:function(l){return e.mouseDown(l,t)},mousemove:function(l){return e.mouseMove(t)},mouseup:function(l){return e.mouseUp(t)},contextmenu:function(l){return l.preventDefault(),e.setDefineData(t)},drop:function(l){return e.dragEnd(t)},dragover:function(l){return l.preventDefault(),e.dragOver(t)},dragleave:function(l){return l.preventDefault(),e.dragLevel(t)}}})})),1)})),0),l("define-menu",{attrs:{store:e.store}})],1)},p=[],g=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"en-excel-tool-bar"},[l("div",{staticClass:"content-tool-bar-item",on:{click:e.clearStyleInfo}},[l("l-icon",{staticClass:"content-tool-bar-main-icon",attrs:{name:"qingchugeshi"}}),l("div",{staticClass:"label"},[e._v(" 清除格式 ")])],1),l("div",{staticClass:"content-tool-bar-item"},[l("div",{staticClass:"content-tool-bar-main"},[l("l-icon",{staticClass:"content-tool-bar-main-icon",attrs:{name:"geshi-wenben"}}),l("div",{staticClass:"label"},[e._v(" 字段格式 ")]),l("l-icon",{staticClass:"content-tool-bar-drop-icon",attrs:{name:"xiala"}})],1),l("div",{staticClass:"content-tool-bar-menu-list"},[l("div",{staticClass:"content-tool-bar-menu-item"},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"geshi-wenben"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 文本 ")])],1),l("div",{staticClass:"content-tool-bar-menu-item"},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"shuzhi-ziduangeshi"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 数值 ")]),l("l-icon",{staticClass:"child-menu-icon",attrs:{name:"xiayiye"}}),l("div",{staticClass:"child-menu"},[l("div",{staticClass:"child-menu-item with-input"},[l("input",{directives:[{name:"model",rawName:"v-model",value:e.digitLength,expression:"digitLength"}],staticClass:"l-input",attrs:{type:"text",placeholder:"请输入"},domProps:{value:e.digitLength},on:{input:function(t){t.target.composing||(e.digitLength=t.target.value)}}}),e._v(" 位小数 ")]),l("div",{staticClass:"child-menu-item"},[e._v(" 字段排序-升序 ")]),l("div",{staticClass:"child-menu-item"},[e._v(" 数值为0显示空 ")]),l("div",{staticClass:"child-menu-item"},[e._v(" 数值为0显示0 ")]),l("div",{staticClass:"child-menu-item"},[e._v(" 数值为0显示-- ")]),l("div",{staticClass:"child-menu-item"},[e._v(" 显示千分符 ")])])],1),l("div",{staticClass:"content-tool-bar-menu-item"},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"jine-ziduangeshi"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 金额 ")]),l("l-icon",{staticClass:"child-menu-icon",attrs:{name:"xiayiye"}}),e._m(0)],1),l("div",{staticClass:"content-tool-bar-menu-item"},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"riqi-ziduangeshi"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 日期 ")]),l("l-icon",{staticClass:"child-menu-icon",attrs:{name:"xiayiye"}}),e._m(1)],1),l("div",{staticClass:"content-tool-bar-menu-item"},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"baifenbi-ziduangeshi"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 百分数 ")])],1)])]),l("div",{staticClass:"content-tool-bar-item"},[l("div",{staticClass:"content-tool-bar-main"},[l("l-icon",{staticClass:"content-tool-bar-main-icon",attrs:{name:"zuoduiqi"}}),l("div",{staticClass:"label"},[e._v(" 对齐方式 ")]),l("l-icon",{staticClass:"content-tool-bar-drop-icon",attrs:{name:"xiala"}})],1),l("div",{staticClass:"content-tool-bar-menu-list"},[l("div",{staticClass:"content-tool-bar-menu-item",on:{click:function(t){return e.textAlign("left")}}},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"zuoduiqi"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 居左对齐 ")])],1),l("div",{staticClass:"content-tool-bar-menu-item",on:{click:function(t){return e.textAlign("center")}}},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"juzhongduiqi"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 居中对齐 ")])],1),l("div",{staticClass:"content-tool-bar-menu-item",on:{click:function(t){return e.textAlign("right")}}},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"youduiqi"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 居右对齐 ")])],1)])]),l("div",{staticClass:"content-tool-bar-item",on:{click:e.mergeCellInfo}},[l("l-icon",{staticClass:"content-tool-bar-main-icon",attrs:{name:"hebing-biaogecaozuo"}}),l("div",{staticClass:"label"},[e._v(" "+e._s(e.store.isSplit?"拆分":"合并")+" ")])],1),l("div",{staticClass:"content-tool-bar-item"},[l("div",{staticClass:"content-tool-bar-main"},[l("l-icon",{staticClass:"content-tool-bar-main-icon",attrs:{name:"liekuan"}}),l("div",{staticClass:"label"},[e._v(" 行高列宽 ")]),l("l-icon",{staticClass:"content-tool-bar-drop-icon",attrs:{name:"xiala"}})],1),l("div",{staticClass:"content-tool-bar-menu-list",staticStyle:{width:"220px"}},[l("div",{staticClass:"content-tool-bar-menu-item"},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"zuoduiqi"}}),l("div",{staticClass:"dropdown-main-label width-label"},[l("div",{staticClass:"component-label"},[e._v(" 设置行高 ")]),l("input",{directives:[{name:"model",rawName:"v-model",value:e.lineHeight,expression:"lineHeight"}],staticClass:"component l-input",attrs:{placeholder:"请输入"},domProps:{value:e.lineHeight},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.changeLineHeight(t)},input:function(t){t.target.composing||(e.lineHeight=t.target.value)}}})])],1),l("div",{staticClass:"content-tool-bar-menu-item"},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"juzhongduiqi"}}),l("div",{staticClass:"dropdown-main-label width-label"},[l("div",{staticClass:"component-label"},[e._v(" 设置列宽 ")]),l("input",{directives:[{name:"model",rawName:"v-model",value:e.cellWidth,expression:"cellWidth"}],staticClass:"component l-input",attrs:{placeholder:"请输入"},domProps:{value:e.cellWidth},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.changeCellWidth(t)},input:function(t){t.target.composing||(e.cellWidth=t.target.value)}}})])],1)])]),l("div",{staticClass:"content-tool-bar-item",class:{active:e.store.allWeight},on:{click:e.fontWeight}},[l("l-icon",{staticClass:"content-tool-bar-main-icon",attrs:{name:"zitijiacu"}}),l("div",{staticClass:"label"},[e._v(" 字体加粗 ")])],1),l("div",{staticClass:"content-tool-bar-item"},[l("div",{staticClass:"content-tool-bar-main"},[l("div",{staticClass:"content-tool-bar-color-picker"},[l("l-icon",{staticClass:"content-tool-bar-main-icon background-color-icon",attrs:{name:"beijingyanse"}}),l("div",{staticClass:"picker-color-container",style:{"background-color":e.dataInfo.backgroundColor}})],1),l("div",{staticClass:"label"},[e._v(" 填充颜色 ")]),l("l-icon",{staticClass:"content-tool-bar-drop-icon",attrs:{name:"xiala"}})],1)]),l("div",{staticClass:"content-tool-bar-item"},[l("div",{staticClass:"content-tool-bar-main"},[l("div",{staticClass:"content-tool-bar-color-picker"},[l("l-icon",{staticClass:"content-tool-bar-main-icon",attrs:{name:"zitiyanse1"}}),l("div",{staticClass:"picker-color-container",style:{"background-color":e.dataInfo.color}})],1),l("div",{staticClass:"label"},[e._v(" 字体颜色 ")]),l("l-icon",{staticClass:"content-tool-bar-drop-icon",attrs:{name:"xiala"}})],1)]),l("div",{staticClass:"content-tool-bar-item"},[l("div",{staticClass:"content-tool-bar-main"},[l("l-icon",{staticClass:"content-tool-bar-main-icon",attrs:{name:"biankuangshezhi"}}),l("div",{staticClass:"label"},[e._v(" 边框设置 ")]),l("l-icon",{staticClass:"content-tool-bar-drop-icon",attrs:{name:"xiala"}})],1),l("div",{staticClass:"content-tool-bar-menu-list"},[l("div",{staticClass:"content-tool-bar-menu-item",on:{click:function(t){return e.borderSetting("noBorder")}}},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"wukuangxian"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 无边框 ")])],1),l("div",{staticClass:"content-tool-bar-menu-item split",on:{click:function(t){return e.borderSetting("allBorder")}}},[l("l-icon",{staticClass:"dropdown-main-icon",attrs:{name:"biankuangshezhi"}}),l("div",{staticClass:"dropdown-main-label"},[e._v(" 所有边框 ")])],1),l("div",{staticClass:"content-tool-bar-menu-item"},[l("div",{staticClass:"dropdown-main-label"},[e._v(" 边框颜色 ")]),l("l-icon",{staticClass:"child-menu-icon",attrs:{name:"xiayiye"}})],1),l("div",{staticClass:"content-tool-bar-menu-item"},[l("div",{staticClass:"dropdown-main-label"},[e._v(" 边框样式 ")]),l("l-icon",{staticClass:"child-menu-icon",attrs:{name:"xiayiye"}}),l("div",{staticClass:"child-menu",staticStyle:{width:"300px"}},[l("div",{staticClass:"child-menu-item line-list",on:{click:function(t){return e.borderSetting("isSolidBorder")}}},[l("div",{staticClass:"line-label"},[e._v(" 粗线 ")]),l("div",{staticClass:"line line-bold"})]),l("div",{staticClass:"child-menu-item line-list",on:{click:function(t){return e.borderSetting("isSolid")}}},[l("div",{staticClass:"line-label"},[e._v(" 细线 ")]),l("div",{staticClass:"line line-normal"})]),l("div",{staticClass:"child-menu-item line-list",on:{click:function(t){return e.borderSetting("isDashed")}}},[l("div",{staticClass:"line-label"},[e._v(" 虚线 ")]),l("div",{staticClass:"line line-dashed"})])])],1)])])])},w=[function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"child-menu"},[l("div",{staticClass:"child-menu-item"},[e._v(" ￥ ")]),l("div",{staticClass:"child-menu-item"},[e._v(" ＄ ")]),l("div",{staticClass:"child-menu-item"},[e._v(" € ")]),l("div",{staticClass:"child-menu-item"},[e._v(" ￡ ")])])},function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"child-menu",staticStyle:{width:"160px"}},[l("div",{staticClass:"child-menu-item"},[e._v(" YYYY/MM/DD ")]),l("div",{staticClass:"child-menu-item"},[e._v(" MM月DD日 ")]),l("div",{staticClass:"child-menu-item"},[e._v(" YYYY年MM月 ")]),l("div",{staticClass:"child-menu-item"},[e._v(" YYYY年MM月DD日 ")]),l("div",{staticClass:"child-menu-item"},[e._v(" YYYY/MM/DD hh:mm:ss ")])])}],v=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("svg",{staticClass:"l-icon",attrs:{"aria-hidden":"true"},on:{click:e.clickIconInfo}},[l("use",{attrs:{"xlink:href":"#icon-"+e.name}})])},y=[],S={name:"lIcon",props:{name:{type:String,default:""}},methods:{clickIconInfo(){this.$emit("click")}}},b=S,B=(l("fab8"),f(b,v,y,!1,null,null,null)),I=B.exports;I.install=e=>{e.component(I.name,I)};var x=I,D={name:"Toolbar",components:{lIcon:x},props:["store"],data(){return{dataInfo:{backgroundColor:"#4694df",color:"#000000",digitNum:0},borderColor:"",isMergeCell:!0,lineHeight:null,cellWidth:null,digitLength:null}},methods:{clearStyleInfo(){this.store.clearStyleInfo(),this.clearStoreInfo()},textAlign(e){this.store.changeCellTextAlign(e),this.clearStoreInfo()},fontWeight(){this.store.changeCellFontWeight(),this.clearStoreInfo()},changeBackgroundColor(e){this.store.changeCellBg(e),this.clearStoreInfo()},changeFontColor(e){this.store.changeCellFontColor(e),this.clearStoreInfo()},borderSetting(e){"noBorder"===e?this.store.changeNoBorderInfo():"allBorder"===e?this.store.changeAllBorderInfo():"isSolidBorder"===e||"isSolid"===e?this.store.changeSolidBorderInfo(e):"isDashed"===e&&this.store.changeDashedBorderInfo(),this.clearStoreInfo()},changeBorderColor(e){this.store.changeBorderColor(e),this.clearStoreInfo()},mergeCellInfo(){this.store.isSplit?this.store.splitCellOp():this.store.mergeCellOp(),this.clearStoreInfo()},changeLineHeight(){this.store.changeCellHeight(this.lineHeight),this.lineHeight=null,this.clearStoreInfo()},changeCellWidth(){this.store.changeCellWidth(this.cellWidth),this.cellWidth=null,this.clearStoreInfo()},clearStoreInfo(){this.store.clearSelectedCells()}}},_=D,k=(l("b455"),f(_,g,w,!1,null,"af918bc4",null)),R=k.exports,W=function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.dataInfo.style.cellSetting.rowSpan>0&&e.dataInfo.style.cellSetting.colSpan>0?l("td",{staticClass:"components-excel-cell",style:{"text-align":e.dataInfo.style.textAlign,"font-weight":e.dataInfo.style.fontWeight?"bold":"normal","background-color":e.dataInfo.style.backgroundColor,color:e.dataInfo.style.fontColor,"border-left-width":e.dataInfo.style.borderStyle.leftBorder.width,"border-top-width":e.dataInfo.style.borderStyle.topBorder.width,"border-right-width":e.dataInfo.style.borderStyle.rightBorder.width,"border-bottom-width":e.dataInfo.style.borderStyle.bottomBorder.width,"border-left-style":e.dataInfo.style.borderStyle.leftBorder.isDashed?"dashed":"solid","border-top-style":e.dataInfo.style.borderStyle.topBorder.isDashed?"dashed":"solid","border-right-style":e.dataInfo.style.borderStyle.rightBorder.isDashed?"dashed":"solid","border-bottom-style":e.dataInfo.style.borderStyle.bottomBorder.isDashed?"dashed":"solid","border-left-color":e.dataInfo.style.borderStyle.leftBorder.color,"border-top-color":e.dataInfo.style.borderStyle.topBorder.color,"border-right-color":e.dataInfo.style.borderStyle.rightBorder.color,"border-bottom-color":e.dataInfo.style.borderStyle.bottomBorder.color,width:e.dataInfo.style.cellStyle.cellWidth&&e.dataInfo.style.cellStyle.cellWidth>0?e.dataInfo.style.cellStyle.cellWidth+"px":null,height:e.dataInfo.style.cellStyle.lineHeight&&e.dataInfo.style.cellStyle.lineHeight>0?e.dataInfo.style.cellStyle.lineHeight+"px":null},attrs:{rowSpan:e.dataInfo.style.cellSetting.rowSpan,colSpan:e.dataInfo.style.cellSetting.colSpan}},[e._v(" "+e._s(e.dataInfo.data.name)+" "),e.store.cellConfig.couldDelete&&e.dataInfo.data.name?l("l-icon",{staticClass:"components-excel-cell-icon",attrs:{name:"shanchu-liebiao"},nativeOn:{click:function(t){return e.removeCellDataInfo(t)}}}):e._e()],1):e._e()},M=[],T={name:"CellModel",props:{dataInfo:{type:Object,default:()=>({})},store:{}},methods:{removeCellDataInfo(){this.dataInfo.removeDataInfo(),this.store.clearSelectedCells()}}},L=T,O=(l("491f"),f(L,W,M,!1,null,null,null)),E=O.exports,A=function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.menuInfo.showMenu?l("div",{ref:"defineMenu",staticClass:"cell-row-insert-dialog",style:{top:e.menuInfo.top+"px",left:e.menuInfo.left+"px"}},[l("div",{staticClass:"cell-row-insert-item"},[l("div",{staticClass:"label"},[e._v(" 在上方插入 ")]),l("el-input",{nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.insertBeforeRows(t)}},model:{value:e.insertInfo.beforeRow,callback:function(t){e.$set(e.insertInfo,"beforeRow",t)},expression:"insertInfo.beforeRow"}}),l("div",{staticClass:"label"},[e._v(" 行 ")])],1),l("div",{staticClass:"cell-row-insert-item"},[l("div",{staticClass:"label"},[e._v(" 在下方插入 ")]),l("el-input",{nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.insertAfterRows(t)}},model:{value:e.insertInfo.afterRow,callback:function(t){e.$set(e.insertInfo,"afterRow",t)},expression:"insertInfo.afterRow"}}),l("div",{staticClass:"label"},[e._v(" 行 ")])],1),l("div",{staticClass:"cell-row-insert-item split",on:{click:e.deleteRows}},[e._v(" 删除所在行 ")]),l("div",{staticClass:"cell-row-insert-item"},[l("div",{staticClass:"label"},[e._v(" 在左侧插入 ")]),l("el-input",{on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.insertCells(1)}},model:{value:e.insertInfo.leftCell,callback:function(t){e.$set(e.insertInfo,"leftCell",t)},expression:"insertInfo.leftCell"}}),l("div",{staticClass:"label"},[e._v(" 列 ")])],1),l("div",{staticClass:"cell-row-insert-item"},[l("div",{staticClass:"label"},[e._v(" 在右侧插入 ")]),l("el-input",{on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.insertCells(-1)}},model:{value:e.insertInfo.rightCell,callback:function(t){e.$set(e.insertInfo,"rightCell",t)},expression:"insertInfo.rightCell"}}),l("div",{staticClass:"label"},[e._v(" 列 ")])],1),l("div",{staticClass:"cell-row-insert-item",on:{click:e.deleteCells}},[e._v(" 删除所在列 ")])]):e._e()},P=[],N={name:"DefineMenu",props:["store","dataInfo"],data(){return{menuInfo:{showMenu:!1,top:0,left:0},insertInfo:{beforeRow:1,afterRow:1,leftCell:1,rightCell:1}}},mounted(){this.checkMenuStatus(),this.checkMenuShow()},methods:{checkMenuStatus(){window.onclick=e=>{if(this.menuInfo.showMenu){let t=this.$refs.defineMenu,l=e.clientX,o=e.clientY,s=t.offsetLeft,i=t.offsetTop,n=t.offsetLeft+t.offsetWidth,r=t.offsetTop+t.offsetHeight;(l<s||l>n||o<i||o>r)&&(this.menuInfo.showMenu=!1)}}},checkMenuShow(){window.oncontextmenu=e=>{"td"===e.target.localName&&(e.preventDefault(),this.menuInfo.showMenu=!0,setTimeout(()=>{let t=document.body.scrollWidth,l=this.$refs.defineMenu.offsetWidth;l+e.clientX-e.layerX+e.target.offsetWidth>t?(this.menuInfo.top=e.clientY-e.layerY+e.target.offsetHeight,this.menuInfo.left=e.clientX-e.layerX+e.target.offsetWidth-l):(this.menuInfo.top=e.clientY-e.layerY+e.target.offsetHeight,this.menuInfo.left=e.clientX-e.layerX+e.target.offsetWidth)},10))}},insertBeforeRows(){this.clearDataInfo(),this.store.insertBeforeRow(this.insertInfo.beforeRow)},insertAfterRows(){this.clearDataInfo(),this.store.insertAfterRow(this.insertInfo.afterRow)},deleteRows(){this.clearDataInfo(),this.store.deleteCurrentRow()},insertCells(){},deleteCells(){this.clearDataInfo(),this.store.deleteCurrentCol()},clearDataInfo(){this.insertInfo={beforeRow:1,afterRow:1,leftCell:1,rightCell:1},this.menuInfo.showMenu=!1}}},$=N,j=(l("f924"),f($,A,P,!1,null,"f376c6fe",null)),H=j.exports,Y={name:"ExcelContent",components:{excelToolbar:R,excelCell:E,defineMenu:H},props:{store:{type:Object,default:()=>({})}},data(){return{isSelectCell:!1,cellInfo:{}}},mounted(){let e=this;window.onmouseup=t=>{"td"!==t.target.localName&&e.isSelectCell&&(e.isSelectCell=!1,e.store.clearSelectedCells())}},methods:{mouseDown(e,t){2!==e.button&&(this.isSelectCell=!0,this.store.clearSelectedCells(),this.store.setCellPositionInfo(t))},mouseMove(e){this.isSelectCell&&this.store.setCellPositionInfo(e)},mouseUp(e){this.store.setCellPositionInfo(e,!0),this.isSelectCell=!1},setDefineData(e){this.store.setMenuDataInfo(e)},dragEnd(e){e.setDataInfo(this.store.dragData),this.store.clearSelectedCells()},dragOver(e){e.setDuringClass()},dragLevel(e){e.removeDuringClass()}}},G=Y,z=(l("9a35"),f(G,m,p,!1,null,"bc857478",null)),F=z.exports;class q{constructor(e,t,l,o,s){this.store=e,this.style={fieldStyle:{text:!1,numericalStyle:{digitNum:null,orderByASC:!1,emptyShowNull:!1,emptyShowZero:!1,emptyShowWait:!1,showThousandSplit:!1},amount:{isRMB:!1,isUSD:!1,isGBP:!1,isEUR:!1},dateFormat:{fullShortDate:!1,monthAndDate:!1,yearAndMonth:!1,fullDate:!1,dateAndTime:!1},percentage:!1},textAlign:"center",cellStyle:{lineHeight:null,cellWidth:null},cellSetting:{colSpan:1,rowSpan:1},fontWeight:!1,backgroundColor:"#ffffff",fontColor:"#000000",borderStyle:{leftBorder:{width:"1px",isSolid:!1,isDashed:!0,color:"#e8ecf2"},rightBorder:{width:"1px",isSolid:!1,isDashed:!0,color:"#e8ecf2"},topBorder:{width:"1px",isSolid:!1,isDashed:!0,color:"#e8ecf2"},bottomBorder:{width:"1px",isSolid:!1,isDashed:!0,color:"#e8ecf2"}}},this.row=o,this.col=s,this.data=t||{},this.id=l||0,this.wasDuring=!1}static setDefaultStyleConfig(){return{fieldStyle:{text:!1,numericalStyle:{digitNum:null,orderByASC:!1,emptyShowNull:!1,emptyShowZero:!1,emptyShowWait:!1,showThousandSplit:!1},amount:{isRMB:!1,isUSD:!1,isGBP:!1,isEUR:!1},dateFormat:{fullShortDate:!1,monthAndDate:!1,yearAndMonth:!1,fullDate:!1,dateAndTime:!1},percentage:!1},textAlign:"center",cellStyle:{lineHeight:null,cellWidth:null},cellSetting:{colSpan:1,rowSpan:1},fontWeight:!1,backgroundColor:"#ffffff",fontColor:"#000000",borderStyle:{leftBorder:{width:"1px",isSolid:!1,isDashed:!0,color:"#e8ecf2"},rightBorder:{width:"1px",isSolid:!1,isDashed:!0,color:"#e8ecf2"},topBorder:{width:"1px",isSolid:!1,isDashed:!0,color:"#e8ecf2"},bottomBorder:{width:"1px",isSolid:!1,isDashed:!0,color:"#e8ecf2"}}}}clearCellStyleInfo(){this.style=q.setDefaultStyleConfig()}setCellFontWeight(e){this.style.fontWeight=e}setCellTextAlign(e){this.style.textAlign=e}setBasicBorderColor(e){this.setRightBorderColor(e),this.setBottomBorderColor(e)}setBasicBorderStyle(e){this.setRightBorderStyle(e),this.setBottomBorderStyle(e)}setBasicBorderWidth(e){this.setRightBorderWidth(e),this.setBottomBorderWidth(e)}setTopBorderColor(e){this.style.borderStyle.topBorder.color=e}setTopBorderWidth(e){this.style.borderStyle.topBorder.width=e}setTopBorderStyle(e){this.style.borderStyle.topBorder.isDashed="isDashed"===e,this.style.borderStyle.topBorder.isSolid="isDashed"!==e}setRightBorderColor(e){this.style.borderStyle.rightBorder.color=e}setRightBorderWidth(e){this.style.borderStyle.rightBorder.width=e}setRightBorderStyle(e){this.style.borderStyle.rightBorder.isDashed="isDashed"===e,this.style.borderStyle.rightBorder.isSolid="isDashed"!==e}setBottomBorderColor(e){this.style.borderStyle.bottomBorder.color=e}setBottomBorderWidth(e){this.style.borderStyle.bottomBorder.width=e}setBottomBorderStyle(e){this.style.borderStyle.bottomBorder.isDashed="isDashed"===e,this.style.borderStyle.bottomBorder.isSolid="isDashed"!==e}setLeftBorderColor(e){this.style.borderStyle.leftBorder.color=e}setLeftBorderWidth(e){this.style.borderStyle.leftBorder.width=e}setLeftBorderStyle(e){this.style.borderStyle.leftBorder.isDashed="isDashed"===e,this.style.borderStyle.leftBorder.isSolid="isDashed"!==e}setCellRowHeight(e){this.style.cellStyle.lineHeight=e}setCellColWidth(e){this.style.cellStyle.cellWidth=e}setCellBackGroundColor(e){this.style.backgroundColor=e}removeDuringClass(){this.wasDuring=!1}setDuringClass(){this.wasDuring=!0}setCellRowSpan(e){this.style.cellSetting.rowSpan=e}setCellColSpan(e){this.style.cellSetting.colSpan=e}setDataInfo(e){this.data=e}removeDataInfo(){this.data={}}setRowLineNum(e){this.row=e}setColLineNum(e){this.col=e}setCellFontColor(e){this.style.fontColor=e}}class X{constructor(){this.couldDelete=!1,this.row=0,this.col=0}}class U{constructor(){this.allCells=[],this.minRow=null,this.minCol=null,this.maxRow=null,this.maxCol=null,this.startCellInfo={row:null,col:null},this.beginCellInfo=null,this.allWeight=!1,this.selectedCells=[],this.mergedCells=[],this.mergedCellsList=[],this.isSplit=!1,this.dragData={},this.cellConfig=new X,this.menuData={}}init(e){this.allCells=e,e.map((e,t)=>{e.map((e,l)=>{new q(this,e.data,e.id,t,l)})})}reGetSelectedCells(){this.selectedCells=[],this.mergedCellsList=[],this.allCells.map(e=>{e.map(e=>{e.wasDuring&&(e.style.cellSetting.rowSpan>0&&e.style.cellSetting.colSpan>0&&this.selectedCells.push(e),this.mergedCellsList.push(e),this.beginCellInfo||(this.beginCellInfo=e))})}),this.isSplit=1===this.selectedCells.length&&(this.selectedCells[0].style.cellSetting.colSpan>1||this.selectedCells[0].style.cellSetting.rowSpan>1),this.checkWeightInfo()}clearSelectedCells(){this.selectedCells.map(e=>{e.wasDuring=!1,e.removeDuringClass()}),this.isSplit&&(this.mergedCellsList.map(e=>{e.wasDuring=!0,e.setDuringClass()}),this.isSplit=!1),this.selectedCells=[],this.selectedCells=[],this.beginCellInfo=null,this.minRow=null,this.maxRow=null,this.minCol=null,this.maxCol=null}checkCellDuringStatus(){this.allCells.map(e=>{e.map(e=>{e.row<=this.maxRow&&e.col<=this.maxCol&&e.row>=this.minRow&&e.col>=this.minCol?e.setDuringClass():e.removeDuringClass()})})}setDefaultList(e,t){e=e||10,t=t||10,this.allCells=[];for(let l=0;l<e;l++){let e=[];for(let o=0;o<t;o++){let t=new q(this,{},(new Date).getTime()+"_"+l+"_"+o,l,o);e.push(t)}this.allCells.push(e)}}changeBorderColor(e){this.reGetSelectedCells(),this.selectedCells.map(t=>{t.setBasicBorderColor(e),0===t.row&&t.setTopBorderColor(e),0!==t.row&&this.allCells[t.row-1][t.col].setBottomBorderColor(e),0===t.col&&t.setLeftBorderColor(e),0!==t.col&&this.allCells[t.row][t.col-1].setRightBorderColor(e)})}changeBorderWidth(e){this.reGetSelectedCells(),this.selectedCells.map(t=>{t.setBasicBorderWidth(e),0===t.row&&t.setTopBorderWidth(e),0!==t.row&&this.allCells[t.row-1][t.col].setBottomBorderWidth(e),0===t.col&&t.setLeftBorderWidth(e),0!==t.col&&this.allCells[t.row][t.col-1].setRightBorderWidth(e)})}changeNoBorderInfo(){let e="#e8ecf2",t="1px",l="isDashed";this.reGetSelectedCells(),this.selectedCells.map(o=>{o.setBasicBorderWidth(t),o.setBasicBorderColor(e),o.setBasicBorderStyle(l),0===o.row&&(o.setTopBorderWidth(t),o.setTopBorderColor(e),o.setTopBorderStyle(l)),0!==o.row&&(this.allCells[o.row-1][o.col].setBottomBorderWidth(t),this.allCells[o.row-1][o.col].setBottomBorderColor(e),this.allCells[o.row-1][o.col].setBottomBorderStyle(l)),0===o.col&&(o.setLeftBorderWidth(t),o.setLeftBorderColor(e),o.setLeftBorderStyle(l)),0!==o.col&&(this.allCells[o.row][o.col-1].setRightBorderWidth(t),this.allCells[o.row][o.col-1].setRightBorderColor(e),this.allCells[o.row][o.col-1].setRightBorderStyle(l))})}changeAllBorderInfo(){let e="#000000",t="1px",l="isSolid";this.reGetSelectedCells(),this.selectedCells.map(o=>{o.setBasicBorderWidth(t),o.setBasicBorderColor(e),o.setBasicBorderStyle(l),0===o.row&&(o.setTopBorderWidth(t),o.setTopBorderColor(e),o.setTopBorderStyle(l)),0!==o.row&&(this.allCells[o.row-1][o.col].setBottomBorderWidth(t),this.allCells[o.row-1][o.col].setBottomBorderColor(e),this.allCells[o.row-1][o.col].setBottomBorderStyle(l)),0===o.col&&(o.setLeftBorderWidth(t),o.setLeftBorderColor(e),o.setLeftBorderStyle(l)),0!==o.col&&(this.allCells[o.row][o.col-1].setRightBorderWidth(t),this.allCells[o.row][o.col-1].setRightBorderColor(e),this.allCells[o.row][o.col-1].setRightBorderStyle(l))})}changeSolidBorderInfo(e){let t="isSolidBorder"===e?"2px":"1px",l="isSolid";this.reGetSelectedCells(),this.changeBorderWidth(t),this.selectedCells.map(e=>{e.setBasicBorderStyle(l),0===e.row&&e.setTopBorderStyle(l),0!==e.row&&this.allCells[e.row-1][e.col].setBottomBorderStyle(l),0===e.col&&e.setLeftBorderStyle(l),0!==e.col&&this.allCells[e.row][e.col-1].setRightBorderStyle(l)})}changeDashedBorderInfo(){let e="1px",t="isDashed";this.reGetSelectedCells(),this.changeBorderWidth(e),this.selectedCells.map(e=>{e.setBasicBorderStyle(t),0===e.row&&e.setTopBorderStyle(t),0!==e.row&&this.allCells[e.row-1][e.col].setBottomBorderStyle(t),0===e.col&&e.setLeftBorderStyle(t),0!==e.col&&this.allCells[e.row][e.col-1].setRightBorderStyle(t)})}changeCellTextAlign(e){this.reGetSelectedCells(),this.selectedCells.map(t=>{t.setCellTextAlign(e)})}changeCellFontWeight(){this.reGetSelectedCells(),this.selectedCells.map(e=>{e.setCellFontWeight(!this.allWeight)})}changeCellHeight(e){this.reGetSelectedCells(),this.selectedCells.map(t=>{t.setCellRowHeight(e)})}changeCellBg(e){this.reGetSelectedCells(),this.selectedCells.map(t=>{t.setCellBackGroundColor(e)})}changeCellFontColor(e){this.reGetSelectedCells(),this.selectedCells.map(t=>{t.setCellFontColor(e)})}changeCellWidth(e){this.reGetSelectedCells(),this.selectedCells.map(t=>{t.setCellColWidth(e)})}clearStyleInfo(){this.allCells.map(e=>{e.map(e=>{e.clearCellStyleInfo()})})}setCellPositionInfo(e,t){null===this.minRow&&null===this.minCol?(this.minRow=e.row,this.minCol=e.col,this.maxRow=e.row,this.maxCol=e.col,this.startCellInfo={row:e.row,col:e.col}):(this.checkPositionInfo(e),t&&this.reGetSelectedCells())}checkPositionInfo(e){let t=e.row+e.style.cellSetting.rowSpan-1,l=e.col+e.style.cellSetting.colSpan-1;t>this.startCellInfo.row?(this.maxRow=t,l>this.startCellInfo.col?this.maxCol=l:(this.maxCol=this.startCellInfo.col,this.minCol=l)):(this.minRow=t,this.maxRow=this.startCellInfo.row,l>this.startCellInfo.col?this.maxCol=l:(this.maxCol=this.startCellInfo.col,this.minCol=l)),this.mergedCells.length>0?this.checkMergeCellInfo():this.checkCellDuringStatus()}checkMergeCellInfo(){let e=this.minRow,t=this.maxRow,l=this.minCol,o=this.maxCol;this.mergedCells.map(s=>{let i=s.row,n=s.row+s.style.cellSetting.rowSpan-1,r=s.col,a=s.col+s.style.cellSetting.colSpan-1;o>=r&&l<=a&&t>=i&&e<=n&&(t<n&&(this.maxRow=n),e>i&&(this.minRow=i),l>r&&(this.minCol=r),o<a&&(this.maxCol=a))}),this.minCol!==l||this.maxCol!==o||this.maxRow!==t||this.minRow!==e?this.checkMergeCellInfo():this.checkCellDuringStatus()}mergeCellOp(){this.reGetSelectedCells();let e=this.beginCellInfo.style.cellSetting.rowSpan,t=this.beginCellInfo.style.cellSetting.colSpan;this.selectedCells.map(l=>{l.row===this.beginCellInfo.row&&l.col!==this.beginCellInfo.col&&(t+=l.style.cellSetting.colSpan),l.row!==this.beginCellInfo.row&&l.col===this.beginCellInfo.col&&(e+=l.style.cellSetting.rowSpan),l!==this.beginCellInfo&&(l.setCellColSpan(0),l.setCellRowSpan(0))}),this.beginCellInfo.setCellRowSpan(e),this.beginCellInfo.setCellColSpan(t),this.mergedCells.push(this.beginCellInfo)}splitCellOp(){this.mergedCellsList.map(e=>{e.setCellRowSpan(1),e.setCellColSpan(1)})}setMenuDataInfo(e){this.menuData=e}insertBeforeRow(e){this.insertRowInfoOp(e)}insertAfterRow(e){this.insertRowInfoOp(e,!0)}insertRowInfoOp(e,t){if(0===this.mergedCells.length)for(let l=0;l<e;l++){let e=[],o=this.menuData.row+l;for(let t=0;t<this.cellConfig.col;t++){let l=new q(this,{},(new Date).getTime()+"_"+o+"_"+t,o,t);e.push(l)}this.allCells.splice(t?o+1:o,0,e)}else this.checkCellEffect(e,t);this.resetCellPositionInfo(e)}checkCellEffect(e,t){this.mergedCells.map(l=>{let o=l.style.cellSetting.rowSpan,s=l.style.cellSetting.colSpan,i=l.row+o-1,n=l.col+s-1,r=this.menuData.row,a=[];if(i>r&&r>=l.row)for(let c=0;c<e;c++)l.setCellRowSpan(o+1),a=this.produceNewRow(),a.map(e=>{l.col<=e.col&&e.col<=n&&(e.setCellRowSpan(0),e.setCellColSpan(0))}),this.allCells.splice(t?r+1:r,0,a);else for(let c=0;c<e;c++)a=this.produceNewRow(),this.allCells.splice(t?r+1:r,0,a)})}produceNewRow(){let e=this.cellConfig.col,t=[];for(let l=0;l<e;l++){let e=new q(this,{},(new Date).getTime()+"_"+l,NaN+l,l,l);t.push(e)}return t}insertBeforeCol(e){this.insertColInfoOp(e,!0)}insertAfterCol(e){this.insertColInfoOp(e)}insertColInfoOp(e,t){if(0===this.mergedCells.length){let e=t?this.menuData.col:this.menuData.col+1;this.allCells.map(t=>{let l=new q(this,{},(new Date).getTime());t.splice(e,0,l)})}else this.checkInsertColEffect(e,t);this.resetCellPositionInfo()}checkInsertColEffect(e,t){let l=t?this.menuData.col:this.menuData.col+1;this.mergedCells.map(o=>{let s=o.style.cellSetting.colSpan,i=o.col+s-1;if((t?l<=i:l<i)&&(t?l>o.col:l>=o.col))for(let t=0;t<e;t++)o.setCellColSpan(s+1)}),this.allCells.map(t=>{let o=!0;t.map(e=>{let t=e.style.cellSetting.colSpan,s=e.col+t-1;(l>e.col&&l<=s||l>e.col&&0===t)&&(o=!1)});for(let s=0;s<e;s++){let e=new q(this,{},(new Date).getTime());e.setCellColSpan(o?1:0),e.setCellRowSpan(o?1:0),t.splice(l,0,e)}})}deleteCurrentRow(){0===this.mergedCells.length&&this.allCells.splice(this.menuData.row,1),this.resetCellPositionInfo()}deleteCurrentCol(){0===this.mergedCells.length&&this.allCells.map(e=>{e.splice(this.menuData.col,1)}),this.resetCellPositionInfo()}resetCellPositionInfo(){this.allCells.map((e,t)=>{e.map((e,l)=>{e.setRowLineNum(t),e.setColLineNum(l),e.id=(new Date).getTime()+"_"+t+"_"+l})})}checkWeightInfo(){let e=!0;this.selectedCells.map(t=>{t.style.fontWeight||(e=!1)}),this.allWeight=e}}var V={name:"VueExcel",components:{excelPanel:C,excelContent:F},props:{showPanel:{type:[String,Boolean],default:!0},value:{type:Array,default:()=>[]},panelList:{type:Object,default:()=>({})},row:{type:[String,Number],default:10},col:{type:[String,Number],default:10},couldDelete:{type:[Boolean,String],default:!0}},data(){return{store:{}}},watch:{value:{deep:!0,immediate:!0,handler(e){this.store=new U,this.setConfigInfo(),e.length>0?this.store.init(e):this.store.setDefaultList(this.row,this.col)}}},methods:{setConfigInfo(){this.store.cellConfig.couldDelete="false"!==this.couldDelete&&!1!==this.couldDelete,this.store.cellConfig.editAble="false"!==this.editAble&&!1!==this.editAble,this.store.cellConfig.row=this.row,this.store.cellConfig.col=this.col}}},Z=V,J=(l("3b15"),f(Z,n,r,!1,null,"0aa2c060",null)),K=J.exports;K.install=e=>{e.component(K.name,K)};var Q=K;const ee=[Q];Object.keys(ee).forEach(e=>{i.a.component(e,ee[e])});var te=Q;t["default"]=te}})}));
//# sourceMappingURL=lExcel.umd.min.js.map